{-# OPTIONS --prop --rewriting --allow-unsolved-metas #-}

open import Diags
open import Arity
open import Sliding
open import Identities
open import BraidingNaturality

∩∣n/n∪∣n : ∀{n} → ∩ ⊗ ∣ ^⊗ (suc n) · ∣ ⊗ /n {suc n} · ∪ ⊗ ∣ ^⊗ (suc n) ~ /n {n}
∩∣n/n∪∣n {n} = ~· (·~ (⊗~ (/nsuc {n}) ■ - ∣⊗·∣⊗) ■ ··
                    ■ ~· (·~ (⊗⊗) ■ - (·⊗·) ■ ~⊗ ·∣∣ ■ ⊗~ (∣n·)) ■ ·~ (⊗⊗))
               ■ ∩⊗·∣/⊗·∪⊗ ■ ·∣n ■ ·∣n

∣n∩/-n∣n∪ : ∀{n} → ∣ ^⊗ (suc n) ⊗ ∩ · /-n {suc n} ⊗ ∣ · ∣ ^⊗ (suc n) ⊗ ∪ ~ /-n {n}
∣n∩/-n∣n∪ = ~· (·~ (~⊗ /-nsuc ■ - ⊗∣·⊗∣ ■ ~· -⊗⊗) ■ ·· ■ ~· (- (·⊗·) ■ ⊗~ ·∣∣))
            ■ ⊗∩·⊗/∣·⊗∪ ■ ·∣n ■ ·~ (- ∣^⊗suc) ■ ·∣n ■ ∣n·

-- The downwards bracket over n strings
∩n : ∀{n} → D n (n + 2)
∩n {n} = ∣ ^⊗ n ⊗ ∩ · /n ⊗ ∣

∩n·∣⊗∣ : ∀{m n}{d : D m n} → ∩n · ∣ ⊗ d ⊗ ∣ ~ d · ∩n
∩n·∣⊗∣ = -·· ■ ·~ (- (·⊗·) ■ ~⊗ /n·∣⊗ ■ ·⊗·)
         ■ ·· ■ ~· (·~ -⊗⊗ ■ - (·⊗·) ■ ~⊗ (∣n·) ■ ⊗~ ·∣∣)
         ■ ~· (~⊗ (- (·∣n)) ■ - ·⊗∩) ■ -··

-- The upwards bracket over n strings
∪n : ∀{n} → D (n + 2) n
∪n {n} = ∣ ⊗ /n · ∪ ⊗ ∣ ^⊗ n

∣⊗∣·∪n : ∀{m n}{d : D m n} → ∣ ⊗ d ⊗ ∣ · ∪n ~ ∪n · d
∣⊗∣·∪n = ·· ■ ~· (~· -⊗⊗ ■ - (·⊗·) ■ ⊗~ (- /n·∣⊗) ■ ·⊗·) ■ -··
         ■ ·~ (~· (⊗⊗) ■ - (·⊗·) ■ ⊗~ (·∣n) ■ ~⊗ ∣∣· ■ ⊗~ (- (∣n·)) ■ - ∪⊗·) ■ ··

-- The downwards bracket under n strings
∩-n : ∀{n} → D n (n + 2)
∩-n {n} = ∩ ⊗ ∣ ^⊗ n · ∣ ⊗ /-n

∩-n·∣⊗∣ : ∀{m n}{d : D m n} → ∩-n · ∣ ⊗ d ⊗ ∣ ~ d · ∩-n
∩-n·∣⊗∣ = -·· ■ ·~ (·~ -⊗⊗ ■ - (·⊗·) ■ ⊗~ /-n·⊗∣ ■ ·⊗·) ■ ·· ■ ~· (·~ (⊗⊗) ■ ⊗∣n·∣∣⊗)
          ■ ~· (- ·⊗∣n) ■ -··

-- The upwards bracket under n strings
∪-n : ∀{n} → D (n + 2) n
∪-n {n} = /-n ⊗ ∣ · ∣ ^⊗ n ⊗ ∪

∣⊗∣·∪-n : ∀{m n}{d : D m n} → ∣ ⊗ d ⊗ ∣ · ∪-n ~ ∪-n · d
∣⊗∣·∪-n = ·· ■ ~· (- (·⊗·) ■ ~⊗ (- /-n·⊗∣) ■ ·⊗·) ■ -··
          ■ ·~ (⊗∣∣·∣n⊗ ■ - ∣n⊗·) ■ ··

∩∣n∩·∪n : ∀{n} → ∩ ⊗ ∣ ^⊗ n ⊗ ∩ · ∪n ~ ∩n
∩∣n∩·∪n {n} = ·· ■ ~· (·~ (- ∣⊗·∣⊗) ■ ·· ■ ~· (·~ (⊗⊗) ■ - (·⊗·) ■ ⊗~ (∩/)
                                                      ■ ~⊗ (·∣n ■ - (∣n·)) ■ ⊗~ (- ·∣∣) ■ ·⊗·)) ■ -·· ■ -··
              ■ ·~ (~· (⊗⊗) ■ ·~ (~· (⊗~ (- ⊗∣·⊗∣) ■ - ∣⊗·∣⊗ ■ ~· (⊗⊗) ■ ·~ (⊗⊗)) ■ ·~ (⊗⊗ ■ ⊗~ ∣^⊗suc ■ ⊗⊗))
                     ■ ·~ (~· ⊗∣·⊗∣ ■ ⊗∣·⊗∣) ■ ⊗∣·⊗∣
                     ■ ~⊗ (·· ■ ~· (~· (-⊗⊗ ■ ⊗~ (- ∣^⊗suc)) ■ ·~ ∣⊗·∣⊗) ■ ·~ -⊗⊗ ■ ∩∣n/n∪∣n))

∩n·∪∣n∪ : ∀{n} → ∩n · ∪ ⊗ ∣ ^⊗ n ⊗ ∪ ~ ∪n
∩n·∪∣n∪ = ~· (- ∩∣n∩·∪n) ■ -·· ■ ·~ (- ∣⊗∣·∪n) ■ ··
          ■ ~· (~· (~⊗ (⊗⊗) ■ -⊗⊗) ■ ·~ (~⊗ (⊗~ -⊗⊗ ■ ⊗⊗) ■ -⊗⊗) ■ - (·⊗·) ■ ~⊗ (∩∪))
          ■ ~· (⊗~ (~· (~⊗ ∣^⊗suc ■ -⊗⊗) ■ ·~ -⊗⊗ ■ - (·⊗·) ■ ⊗~ (∪∩) ■ ~⊗ (·∣n) ■ - ∣^⊗suc)) ■ ∣n·

∩∣n∩·∪-n : ∀{n} → ∩ ⊗ ∣ ^⊗ n ⊗ ∩ · ∪-n ~ ∩-n
∩∣n∩·∪-n = ·· ■ ~· (·~ (- ⊗∣·⊗∣) ■ ·· ■ ~· (~· -⊗⊗ ■ ·~ -⊗⊗ ■ - (·⊗·) ■ ~⊗ (∩/)
                                                  ■ ⊗~ (·~ (-⊗⊗ ■ ⊗~ (- ∣^⊗suc)) ■ ·∣n ■ - (∣n·)) ■ ~⊗ (- ·∣∣) ■ ·⊗·))
           ■ -·· ■ -··
           ■ ·~ (·~ (~· (~⊗ (- ∣⊗·∣⊗) ■ - ⊗∣·⊗∣)) ■ ·· ■ ·~ -⊗⊗
           ■ ~· (~· (-⊗⊗ ■ ⊗~ (⊗⊗)) ■ ·~ (~· -⊗⊗ ■ ·~ -⊗⊗ ■ ∣⊗·∣⊗))
           ■ ~· (·~ (⊗~ ⊗∣·⊗∣) ■ ∣⊗·∣⊗) ■ ∣⊗·∣⊗ ■ ⊗~ ∣n∩/-n∣n∪)

∩-n·∪∣n∪ : ∀{n} → ∩-n · ∪ ⊗ ∣ ^⊗ n ⊗ ∪ ~ ∪-n
∩-n·∪∣n∪ = ~· (- ∩∣n∩·∪-n) ■ -·· ■ ·~ (- ∣⊗∣·∪-n) ■ ··
           ■ ~· (~· (~⊗ (⊗⊗) ■ -⊗⊗) ■ ·~ (~⊗ (⊗~ -⊗⊗ ■ ⊗⊗) ■ -⊗⊗) ■ - (·⊗·) ■ ~⊗ (∩∪))
           ■ ~· (⊗~ (~· (~⊗ ∣^⊗suc ■ -⊗⊗) ■ ·~ -⊗⊗ ■ - (·⊗·) ■ ⊗~ (∪∩) ■ ~⊗ (·∣n)) ■ ⊗~ (- ∣^⊗suc)) ■ ∣n·

∪n~∪-n : ∀{m}{d : D m 0} → ∪n · d ~ ∪-n · d
∪n~∪-n = - ∣⊗∣·∪n ■ ·~ (·~ (⊗ε ■ - (ε⊗))) ■ ∣⊗∣·∪-n

∩n~∩-n : ∀{m}{d : D 0 m} → d · ∩n ~ d · ∩-n
∩n~∩-n = - ∩n·∣⊗∣ ■ ~· (~· (ε⊗ ■ - (⊗ε))) ■ ∩-n·∣⊗∣

∩n~∩-n' : ∀{m}{d : D (m + 2) 0} → ∩n · d ~ ∩-n · d
∩n~∩-n' = ~· (- ∩∣n∩·∪n) ■ -·· ■ ·~ ∪n~∪-n ■ ·· ■ ~· ∩∣n∩·∪-n

∪n~∪-n' : ∀{m}{d : D 0 (m + 2)} → d · ∪n ~ d · ∪-n
∪n~∪-n' = ·~ (- ∩n·∪∣n∪) ■ ·· ■ ~· ∩n~∩-n ■ -·· ■ ·~ ∩-n·∪∣n∪


