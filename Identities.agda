{-# OPTIONS --prop --rewriting --allow-unsolved-metas #-}

open import Diags

∣· : ∀{n}{d : D 1 n} → ∣ · d ~* d
∣· = ~·* (- (ι ⊗ε)) ■ ι ∣n·

·∣ : ∀{n}{d : D n 1} → d · ∣  ~* d
·∣ = - (ι (·~ ⊗ε)) ■ ι ·∣n

∣∣· : ∀{n}{d : D 2 n} → ∣ ⊗ ∣ · d ~* d
∣∣· = - (~·* (ι ⊗⊗ ■ ι ⊗ε))  ■ ι ∣n·

·∣∣ : ∀{n}{d : D n 2} → d · ∣ ⊗ ∣ ~* d
·∣∣ = - (·~* (ι ⊗⊗ ■ ι ⊗ε))  ■ ι ·∣n

∣∣∣· : ∀{n}{d : D 3 n} → ∣ ⊗ ∣ ⊗ ∣ · d ~* d
∣∣∣· = ~·* (- (ι ⊗⊗ ■ ι (⊗~ ⊗ε))) ■ ι ∣n·

·∣∣∣ : ∀{n}{d : D n 3} → d · ∣ ⊗ ∣ ⊗ ∣ ~* d
·∣∣∣ = ·~* (- (ι (⊗~ ⊗ε)) ■ - (ι ⊗⊗)) ■ ι ·∣n

∪⊗· : ∀{m n k}{d : D m n}{e : D n k} → ∪ ⊗ d · e ~* ∪ ⊗ (d · e)
∪⊗· = - (ι (·~ ε⊗)) ■ - (ι ⊗·⊗) ■ ι (~⊗ ·ε)

⊗∪· : ∀{m n k}{d : D m n}{e : D n k} → d ⊗ ∪ · e ~* (d · e) ⊗ ∪
⊗∪· = - (ι (·~ ⊗ε)) ■ - (ι ⊗·⊗) ■ ι (⊗~ ·ε)

·∩⊗ : ∀{m n k}{d : D m n}{e : D n k} → d · ∩ ⊗ e ~* ∩ ⊗ (d · e)
·∩⊗ = - (ι (~· ε⊗)) ■ - (ι ⊗·⊗) ■ ι (~⊗ ε·)

·⊗∩ : ∀{m n k}{d : D m n}{e : D n k} → d · e ⊗ ∩ ~* (d · e) ⊗ ∩
·⊗∩ = - (ι (~· ⊗ε)) ■ - (ι ⊗·⊗) ■ ι (⊗~ ε·)

·∪∣·∣∩· : ∀{m n}{d : D m 3}{d' : D 3 n} → d · ∪ ⊗ ∣ · ∣ ⊗ ∩ · d' ~* d ⊗ ∩ · ∪ ⊗ d'
·∪∣·∣∩· = ~·* (·⊗∩ ■ ~⊗* ·∣ ■ ⊗~* (-  ·∣∣) ■ ι ⊗·⊗)
          ■ - (ι ··) ■ ·~* (- (ι (~· ⊗⊗)) ■ ∪⊗· ■ ⊗~* (ι (~· ⊗⊗) ■ ∣∣∣·))

/⁻¹∣∣/⁻¹ :    /⁻¹ ⊗ ∣
           · ∣ ⊗ /⁻¹  ~* ∣ ⊗ ∣ ⊗ ∣ ⊗   ∩
                       · ∣ ⊗ ∣ ⊗   /   ⊗ ∣
                       · ∣ ⊗   /   ⊗ ∣ ⊗ ∣
                       ·   ∪   ⊗ ∣ ⊗ ∣ ⊗ ∣
/⁻¹∣∣/⁻¹ = {!!}
