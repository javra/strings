{-# OPTIONS --prop --rewriting --allow-unsolved-metas #-}

open import Diags
open import Arity

∪⊗· : ∀{m n k}{d : D m n}{e : D n k} → ∪ ⊗ d · e ~* ∪ ⊗ (d · e)
∪⊗· = - (ι (·~ ε⊗)) ■ - (ι ·⊗·) ■ ι (~⊗ ·ε)

⊗∪· : ∀{m n k}{d : D m n}{e : D n k} → d ⊗ ∪ · e ~* (d · e) ⊗ ∪
⊗∪· = - (ι (·~ ⊗ε)) ■ - (ι ·⊗·) ■ ι (⊗~ ·ε)

·∩⊗ : ∀{m n k}{d : D m n}{e : D n k} → d · ∩ ⊗ e ~* ∩ ⊗ (d · e)
·∩⊗ = - (ι (~· ε⊗)) ■ - (ι ·⊗·) ■ ι (~⊗ ε·)

·⊗∩ : ∀{m n k}{d : D m n}{e : D n k} → d · e ⊗ ∩ ~* (d · e) ⊗ ∩
·⊗∩ = - (ι (~· ⊗ε)) ■ - (ι ·⊗·) ■ ι (⊗~ ε·)

·∪∣·∣∩· : ∀{m n}{d : D m 3}{d' : D 3 n} → d · ∪ ⊗ ∣ · ∣ ⊗ ∩ · d' ~* d ⊗ ∩ · ∪ ⊗ d'
·∪∣·∣∩· = ~·* (·⊗∩ ■ ~⊗* ·∣ ■ ⊗~* (-  ·∣∣) ■ ι ·⊗·)
          ■ - (ι ··) ■ ·~* (- (ι (~· ⊗⊗)) ■ ∪⊗· ■ ⊗~* (ι (~· ⊗⊗) ■ ∣∣∣·))

·∪∣∣·∣∣∩· : ∀{m n}{d : D m 4}{d' : D 4 n} → d · ∪ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∩ · d' ~* d ⊗ ∩ · ∪ ⊗ d'
·∪∣∣·∣∣∩· = ~·* (·⊗∩ ■ ~⊗* ·∣∣ ■ ⊗~* (- ·∣∣) ■ ι ·⊗·) ■ - (ι ··)
            ■ ·~* (~·* (- ⊗⊗⊗) ■ ∪⊗· ■ ⊗~* (~·* (ι ⊗⊗ ■ ι ⊗⊗) ■ ∣∣∣∣·))

·∪∣∣∣·∣∣∣∩· : ∀{m n}{d : D m 5}{d' : D 5 n} → d · ∪ ⊗ ∣ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∣ ⊗ ∩ · d' ~* d ⊗ ∩ · ∪ ⊗ d'
·∪∣∣∣·∣∣∣∩· = ~·* (·⊗∩ ■ ~⊗* ·∣∣∣ ■ ⊗~* (- ·∣∣) ■ ι ·⊗·) ■ - (ι ··)
              ■ ·~* (~·* (- ⊗⊗⊗⊗) ■ ∪⊗·
                     ■ ⊗~* (~·* ⊗⊗⊗⊗ ■ ∣∣∣∣∣·)) 

/⁻¹∣∣/⁻¹ :    /⁻¹ ⊗ ∣
           · ∣ ⊗ /⁻¹  ~* ∣ ⊗ ∣ ⊗ ∣ ⊗   ∩
                       · ∣ ⊗ ∣ ⊗   /   ⊗ ∣
                       · ∣ ⊗   /   ⊗ ∣ ⊗ ∣
                       ·   ∪   ⊗ ∣ ⊗ ∣ ⊗ ∣
/⁻¹∣∣/⁻¹ = ~·* (⊗~* (- (·∣ ■ ·∣)) ■ {!!})
           ■ {!!}
