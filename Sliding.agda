{-# OPTIONS --prop --rewriting --allow-unsolved-metas #-}

open import Diags
open import Arity

-·· : ∀{m n k l}{d : D m n}{e : D n k}{f : D k l} → d · e · f ~ d · (e · f)
-·· = - ··

-⊗⊗ : ∀{m m' n n' k k'}{d : D m m'}{e : D n n'}{f : D k k'} → d ⊗ e ⊗ f ~ d ⊗ (e ⊗ f)
-⊗⊗ = - ⊗⊗

∪⊗· : ∀{m n k}{d : D m n}{e : D n k} → ∪ ⊗ d · e ~ ∪ ⊗ (d · e)
∪⊗· = - (·~ ε⊗) ■ - ·⊗· ■ ~⊗ ·ε

⊗∪· : ∀{m n k}{d : D m n}{e : D n k} → d ⊗ ∪ · e ~ (d · e) ⊗ ∪
⊗∪· = - (·~ ⊗ε) ■ - ·⊗· ■ ⊗~ ·ε

·∩⊗ : ∀{m n k}{d : D m n}{e : D n k} → d · ∩ ⊗ e ~ ∩ ⊗ (d · e)
·∩⊗ = -  (~· ε⊗) ■ - ·⊗· ■ ~⊗ ε·

·⊗∩ : ∀{m n k}{d : D m n}{e : D n k} → d · e ⊗ ∩ ~ (d · e) ⊗ ∩
·⊗∩ = - (~· ⊗ε) ■ - ·⊗· ■ ⊗~ ε·

·∪∣·∣∩· : ∀{m n}{d : D m 3}{d' : D 3 n} → d · ∪ ⊗ ∣ · ∣ ⊗ ∩ · d' ~ d ⊗ ∩ · ∪ ⊗ d'
·∪∣·∣∩· = ~· (·⊗∩ ■ ~⊗ ·∣ ■ ⊗~ (- ·∣∣) ■ ·⊗·)
          ■ -·· ■ ·~ (- (~· ⊗⊗) ■ ∪⊗· ■ ⊗~ ((~· ⊗⊗) ■ ∣∣∣·))

·∪∣∣·∣∣∩· : ∀{m n}{d : D m 4}{d' : D 4 n} → d · ∪ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∩ · d' ~ d ⊗ ∩ · ∪ ⊗ d'
·∪∣∣·∣∣∩· = ~· (·⊗∩ ■ ~⊗ ·∣∣ ■ ⊗~ (- ·∣∣) ■ ·⊗·) ■ -··
            ■ ·~ (~· (- ⊗⊗⊗) ■ ∪⊗· ■ ⊗~ (~· (⊗⊗ ■ ⊗⊗) ■ ∣∣∣∣·))

·∪∣∣∣·∣∣∣∩· : ∀{m n}{d : D m 5}{d' : D 5 n} → d · ∪ ⊗ ∣ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∣ ⊗ ∩ · d' ~ d ⊗ ∩ · ∪ ⊗ d'
·∪∣∣∣·∣∣∣∩· = ~· (·⊗∩ ■ ~⊗ ·∣∣∣ ■ ⊗~ (- ·∣∣) ■ ·⊗·) ■ -··
              ■ ·~ (~· (- ⊗⊗⊗⊗) ■ ∪⊗·
                     ■ ⊗~ (~· ⊗⊗⊗⊗ ■ ∣∣∣∣∣·))

Dn0⊗D0m : ∀{m n}{d : D m 0}{e : D 0 n} → d ⊗ e ~ d · e
Dn0⊗D0m = ~⊗ (- ·ε) ■ ⊗~ (- ε·) ■ ·⊗· ■ ~· ⊗ε ■ ·~ ε⊗

D0n⊗Dm0 : ∀{m n}{d : D 0 m}{e : D n 0} → d ⊗ e ~ e · d
D0n⊗Dm0 = ~⊗ (- ε·) ■ ⊗~ (- ·ε) ■ ·⊗· ■ ~· ε⊗ ■ ·~ ⊗ε

∣∣⊗· : ∀{m n}{d : D m 0}{e : D 2 n} → ∣ ⊗ ∣ ⊗ d · e ~ e ⊗ d
∣∣⊗· = ·~ (- ⊗ε) ■ - ·⊗· ■ ~⊗ ∣∣· ■ ⊗~ ·ε

∣∣∣⊗· : ∀{m n}{d : D m 0}{e : D 3 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ~ e ⊗ d
∣∣∣⊗· = ·~ (- ⊗ε) ■ - ·⊗· ■ ~⊗ ∣∣∣· ■ ⊗~ ·ε

∣∣∣∣⊗· : ∀{m n}{d : D m 0}{e : D 4 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ~ e ⊗ d
∣∣∣∣⊗· = ·~ (- ⊗ε) ■ - ·⊗· ■ ~⊗ ∣∣∣∣· ■ ⊗~ ·ε

⊗∣∣· : ∀{m n}{d : D m 0}{e : D 2 n} → d ⊗ ∣ ⊗ ∣ · e ~ d ⊗ e
⊗∣∣· = ~· -⊗⊗ ■ ·~ (- ε⊗) ■ - ·⊗· ■ ~⊗ ·ε ■ ⊗~ ∣∣·

⊗∣∣∣· : ∀{m n}{d : D m 0}{e : D 3 n} → d ⊗ ∣ ⊗ ∣ ⊗ ∣ · e ~ d ⊗ e
⊗∣∣∣· = ~· (-⊗⊗ ■ -⊗⊗ ■ ⊗~ ⊗⊗) ■ ·~ (- ε⊗) ■ - ·⊗· ■ ~⊗ ·ε ■ ⊗~ ∣∣∣·

·⊗∣∣ : ∀{m n}{d : D m 2}{e : D 0 n} → d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
·⊗∣∣ = ~· (- ε⊗) ■ ·~ -⊗⊗ ■ - ·⊗· ■ ~⊗ ε· ■ ⊗~ ·∣∣

·∣∣⊗ : ∀{m n}{d : D m 2}{e : D 0 n} → d · ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
·∣∣⊗ = ~· (- ⊗ε) ■ - ·⊗· ■ ⊗~ ε· ■ ~⊗ ·∣∣

·∣∣∣⊗ : ∀{m n}{d : D m 3}{e : D 0 n} → d · ∣ ⊗ ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
·∣∣∣⊗ = ~· (- ⊗ε) ■ - ·⊗· ■ ⊗~ ε· ■ ~⊗ ·∣∣∣

∣⊗·⊗∣∣ : ∀{m n}{d : D m 2}{e : D 1 n} → ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣⊗·⊗∣∣ = ·~ -⊗⊗ ■ - ·⊗· ■ ~⊗ ∣· ■ ⊗~ ·∣∣

∣∣⊗·⊗∣∣ : ∀{m n}{d : D m 2}{e : D 2 n} → ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣∣⊗·⊗∣∣ = ·~ -⊗⊗ ■ - ·⊗· ■ ~⊗ ∣∣· ■ ⊗~ ·∣∣

∣∣∣⊗·⊗∣ : ∀{m n}{d : D m 1}{e : D 3 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ~ e ⊗ d
∣∣∣⊗·⊗∣ = - ·⊗· ■ ~⊗ ∣∣∣· ■ ⊗~ ·∣

∣∣⊗·⊗∣∣∣ : ∀{m n}{d : D m 3}{e : D 2 n} → ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣∣⊗·⊗∣∣∣ = (·~ (- ⊗⊗⊗)) ■ - ·⊗· ■ ~⊗ ∣∣· ■ ⊗~ (·~ ⊗⊗ ■ ·∣∣∣)

∣∣∣⊗·⊗∣∣ : ∀{m n}{d : D m 2}{e : D 3 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣∣∣⊗·⊗∣∣ = ·~ -⊗⊗ ■ - ·⊗· ■ ~⊗ ∣∣∣· ■ ⊗~ ·∣∣

∣∣∣⊗·⊗∣∣∣ : ∀{m n}{d : D m 3}{e : D 3 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣∣∣⊗·⊗∣∣∣ = ·~ (- ⊗⊗⊗) ■ - ·⊗· ■ ~⊗ ∣∣∣· ■ ⊗~ (·~ ⊗⊗ ■ ·∣∣∣)

∣∣∣∣⊗·⊗∣∣ : ∀{m n}{d : D m 2}{e : D 4 n} → ∣ ⊗ ∣ ⊗ ∣ ⊗ ∣ ⊗ d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣∣∣∣⊗·⊗∣∣ = ·~ -⊗⊗  ■ - ·⊗· ■ ~⊗ ∣∣∣∣· ■ ⊗~ ·∣∣

·⊗∣n : ∀{m k l}{d : D k l}{e : D 0 m} → d · e ⊗ ∣ ^⊗ l ~ e ⊗ d
·⊗∣n = ~· (- ε⊗) ■ - ·⊗· ■ ~⊗ ε· ■ ⊗~ ·∣n

∣n⊗· : ∀{m k l}{d : D m 0}{e : D k l} → ∣ ^⊗ _ ⊗ d · e ~ e ⊗ d
∣n⊗· = ·~ (- ⊗ε) ■ - ·⊗· ■ ~⊗ ∣n· ■ ⊗~ ·ε

∣n⊗·⊗∣∣ : ∀{m k l}{d : D m 2}{e : D k l} → ∣ ^⊗ _ ⊗ d · e ⊗ ∣ ⊗ ∣ ~ e ⊗ d
∣n⊗·⊗∣∣ = ·~ -⊗⊗ ■ - ·⊗· ■ ~⊗ ∣n· ■ ⊗~ ·∣∣

⊗∣n·∣∣⊗ : ∀{m k l}{d : D m 2}{e : D k l} → d ⊗ ∣ ^⊗ _ · ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣n·∣∣⊗ = - ·⊗· ■ ~⊗ ·∣∣ ■ ⊗~ ∣n·

⊗∣∣·∣n⊗ : ∀{m k l}{d : D k l}{e : D 2 m} → d ⊗ ∣ ⊗ ∣ · ∣ ^⊗ _ ⊗ e ~ d ⊗ e
⊗∣∣·∣n⊗ = ~· -⊗⊗ ■ - ·⊗· ■ ⊗~ ∣∣· ■ ~⊗ ·∣n

∣n⊗·⊗∣m : ∀{m n k l}{d : D m n}{e : D k l} → ∣ ^⊗ _ ⊗ d · e ⊗ ∣ ^⊗ n ~ e ⊗ d
∣n⊗·⊗∣m = - ·⊗· ■ ~⊗ ∣n· ■ ⊗~ ·∣n

⊗∣·⊗ : ∀{m n}{d : D m 0}{e : D 1 n} → d ⊗ ∣ · e ~ d ⊗ e
⊗∣·⊗ = ·~ (- ε⊗) ■ - ·⊗· ■ ~⊗ ·ε ■ ⊗~ ∣·

⊗∣∣·∣⊗ : ∀{m n}{d : D m 1}{e : D 2 n} → d ⊗ ∣ ⊗ ∣ · ∣ ⊗ e ~ d ⊗ e
⊗∣∣·∣⊗ = ~· -⊗⊗ ■ - ·⊗· ■ ~⊗ ·∣ ■ ⊗~ ∣∣·

⊗∣∣·∣∣⊗ : ∀{m n}{d : D m 2}{e : D 2 n} → d ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣∣·∣∣⊗ = ~· -⊗⊗ ■ - ·⊗· ■ ~⊗ ·∣∣ ■ ⊗~ ∣∣·

⊗∣∣∣·∣∣⊗ : ∀{m n}{d : D m 2}{e : D 3 n} → d ⊗ ∣ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣∣∣·∣∣⊗ = ~· (- (⊗⊗ ■ ~⊗ ⊗⊗)) ■ - ·⊗· ■ ~⊗ ·∣∣ ■ ⊗~ ∣∣∣·

⊗∣∣·∣∣∣⊗ : ∀{m n}{d : D m 3}{e : D 2 n} → d ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣∣·∣∣∣⊗ = ~· -⊗⊗ ■ - ·⊗· ■ ~⊗ ·∣∣∣ ■ ⊗~ ∣∣·

⊗∣∣∣·∣∣∣⊗ : ∀{m n}{d : D m 3}{e : D 3 n} → d ⊗ ∣ ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣∣∣·∣∣∣⊗ = ~· (-⊗⊗ ■ -⊗⊗ ■ ⊗~ ⊗⊗) ■ - ·⊗· ■ ~⊗ ·∣∣∣ ■ ⊗~ ∣∣∣·

⊗∣∣·∣∣∣∣⊗ : ∀{m n}{d : D m 4}{e : D 2 n} → d ⊗ ∣ ⊗ ∣ · ∣ ⊗ ∣ ⊗ ∣ ⊗ ∣ ⊗ e ~ d ⊗ e
⊗∣∣·∣∣∣∣⊗ = ~· -⊗⊗ ■ - ·⊗· ■ ~⊗ ·∣∣∣∣ ■ ⊗~ ∣∣·

⊗∣n·∣m⊗ : ∀{m n k l}{d : D m n}{e : D k l} → d ⊗ ∣ ^⊗ k · ∣ ^⊗ n ⊗ e ~ d ⊗ e
⊗∣n·∣m⊗ = - ·⊗· ■ ~⊗ ·∣n ■ ⊗~ ∣n·
